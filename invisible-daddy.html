<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœ‹ä¸è§çš„æ‰‹è®©æˆ‘æœ€å¤§åŒ–äº† - SmithHub</title>
    <style>
        body { background-color: #000; color: #fff; font-family: Arial, sans-serif; margin: 0; }
        a { text-decoration: none; color: inherit; }
        
        header { background-color: #1b1b1b; padding: 15px 20px; display: flex; align-items: center; border-bottom: 1px solid #333; }
        .logo { font-size: 24px; font-weight: bold; }
        .logo span { background: #ff9900; color: #000; padding: 2px 5px; border-radius: 3px; }

        .main-container { max-width: 1000px; margin: 20px auto; padding: 0 15px; }

        .video-wrapper {
            background: #111;
            border: 1px solid #333;
            margin-bottom: 15px;
        }

        .animation-container {
            width: 100%;
            aspect-ratio: 16/9;
            background: linear-gradient(180deg, #0a0a0a 0%, #111 100%);
            position: relative;
            overflow: hidden;
        }

        #graph-canvas {
            width: 100%;
            height: 100%;
        }

        /* æ§åˆ¶æ¡ */
        .controls {
            background: #1b1b1b;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .play-btn {
            background: #ff9900;
            border: none;
            color: #000;
            padding: 8px 20px;
            font-weight: bold;
            cursor: pointer;
            font-size: 14px;
        }

        .play-btn:hover { background: #ffaa22; }

        .progress-bar {
            flex: 1;
            height: 4px;
            background: #333;
            cursor: pointer;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: #ff9900;
            width: 0%;
            transition: width 0.1s;
        }

        .time-display { color: #888; font-size: 12px; }

        /* æ ‡é¢˜ç­‰ */
        .video-title { font-size: 24px; margin: 15px 0 10px 0; color: #fff; }
        .video-stats { color: #888; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        
        .action-buttons { display: flex; gap: 10px; flex-wrap: wrap; }
        .action-btn { background: #333; color: #fff; border: none; padding: 8px 15px; cursor: pointer; font-size: 13px; }
        .action-btn:hover { background: #444; }
        .btn-orange { color: #ff9900; }

        .tags { margin: 15px 0; }
        .tag { background:#222; padding:5px 10px; border-radius:10px; color:#888; font-size:12px; margin-right: 5px; display: inline-block; }

        .description { background: #111; border: 1px solid #333; padding: 20px; margin-top: 15px; color: #ccc; line-height: 1.8; }
        .description h3 { color: #ff9900; margin-bottom: 15px; font-size: 16px; }

        /* çŠ¶æ€æ–‡å­—è¦†ç›–å±‚ */
        .status-overlay {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            padding: 10px 25px;
            border: 1px solid #ff9900;
            font-size: 18px;
            color: #ff9900;
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 10;
        }

        .status-overlay.visible { opacity: 1; }

        /* æœ€é«˜æ½®ç‰¹æ•ˆ */
        .climax-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,153,0,0.3) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 5;
        }

        .climax-overlay.visible { opacity: 1; }

        @media (max-width: 600px) {
            .video-title { font-size: 18px; }
            .controls { flex-wrap: wrap; }
        }
    </style>
</head>
<body>

<header>
    <a href="index.html" class="logo">Smith<span>Hub</span></a>
    <div style="margin-left:auto; color:#888;">Premium Content</div>
</header>

<div class="main-container">
    
    <div class="video-wrapper">
        <div class="animation-container">
            <canvas id="graph-canvas"></canvas>
            <div class="status-overlay" id="status">å‡†å¤‡å¼€å§‹...</div>
            <div class="climax-overlay" id="climax"></div>
        </div>
        <div class="controls">
            <button class="play-btn" id="playBtn">â–¶ å¼€å§‹</button>
            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <span class="time-display" id="timeDisplay">0:00 / 0:15</span>
        </div>
    </div>

    <h1 class="video-title">çœ‹ä¸è§çš„æ‰‹è®©æˆ‘æœ€å¤§åŒ–äº† - å®Œæ•´å¸‚åœºå‡è¡¡è¿‡ç¨‹ (åŠ¨ç”»æ¼”ç¤º)</h1>
    
    <div class="video-stats">
        <span>1776ä¸‡æ¬¡è§‚çœ‹ Â· 248å¹´å‰ä¸Šä¼ </span>
        
        <div class="action-buttons">
            <button class="action-btn btn-orange">ğŸ‘ å¸•ç´¯æ‰˜æ”¹è¿› 177.6K</button>
            <button class="action-btn">ğŸ‘ æ— è°“æŸå¤±</button>
            <button class="action-btn">â†ª å¤–éƒ¨æ€§ä¼ æ’­</button>
            <button class="action-btn">ğŸ’¾ åŠ å…¥æŠ•èµ„ç»„åˆ</button>
        </div>
    </div>

    <div class="tags">
        <span class="tag">#InvisibleHand</span>
        <span class="tag">#ä¾›éœ€å‡è¡¡</span>
        <span class="tag">#å¸•ç´¯æ‰˜æœ€ä¼˜</span>
        <span class="tag">#å¸‚åœºå‡ºæ¸…</span>
        <span class="tag">#AdamSmith</span>
        <span class="tag">#æƒ…äººèŠ‚ç‰¹è¾‘</span>
    </div>

    <div class="description">
        <h3>ğŸ“‹ å†…å®¹ç®€ä»‹</h3>
        <p>
            è§‚çœ‹<strong>ä¾›ç»™</strong>ä¸<strong>éœ€æ±‚</strong>å¦‚ä½•åœ¨<strong>çœ‹ä¸è§çš„æ‰‹</strong>çš„å¼•å¯¼ä¸‹ï¼Œè¾¾åˆ°å®Œç¾çš„<strong>å¸‚åœºå‡è¡¡</strong>ã€‚
        </p>
        <p>
            åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œ<strong>æ¶ˆè´¹è€…å‰©ä½™</strong>ä¸<strong>ç”Ÿäº§è€…å‰©ä½™</strong>åŒæ—¶è¾¾åˆ°æœ€å¤§åŒ–ï¼Œå®ç°<strong>å¸•ç´¯æ‰˜æœ€ä¼˜</strong>çŠ¶æ€ã€‚
        </p>
        <p>
            æ²¡æœ‰æ”¿åºœå¹²é¢„ï¼Œæ²¡æœ‰ä»·æ ¼ç®¡åˆ¶ï¼Œåªæœ‰ä¸¤æ¡æ›²çº¿ã€ä¸€åªçœ‹ä¸è§çš„æ‰‹ã€ä»¥åŠä¸€ä¸ªå®Œç¾çš„äº¤ç‚¹ã€‚
        </p>
        <p style="color: #ff9900; font-style: italic;">
            "æ¯ä¸ªäººè¿½æ±‚è‡ªå·±çš„åˆ©ç›Šï¼Œå´åœ¨çœ‹ä¸è§çš„æ‰‹å¼•å¯¼ä¸‹ï¼Œä¿ƒè¿›äº†ç¤¾ä¼šçš„æ•´ä½“ç¦åˆ©ã€‚" â€”â€” Adam Smith, 1776
        </p>
    </div>

</div>

<script>
// è·å–ç”»å¸ƒ
const canvas = document.getElementById('graph-canvas');
const ctx = canvas.getContext('2d');
const status = document.getElementById('status');
const climax = document.getElementById('climax');
const playBtn = document.getElementById('playBtn');
const progressFill = document.getElementById('progressFill');
const timeDisplay = document.getElementById('timeDisplay');

// åŠ¨ç”»å‚æ•°
let animationId = null;
let isPlaying = false;
let progress = 0;
const duration = 15000; // 15ç§’
let startTime = null;

// è°ƒæ•´ç”»å¸ƒå¤§å°
function resizeCanvas() {
    const container = canvas.parentElement;
    canvas.width = container.clientWidth * 2; // é«˜æ¸…
    canvas.height = container.clientHeight * 2;
    ctx.scale(2, 2);
}

resizeCanvas();
window.addEventListener('resize', resizeCanvas);

// ç”»å¸ƒå®é™…æ˜¾ç¤ºå°ºå¯¸
function getSize() {
    return {
        w: canvas.width / 2,
        h: canvas.height / 2
    };
}

// ç»˜åˆ¶åæ ‡è½´
function drawAxes() {
    const { w, h } = getSize();
    const margin = 60;
    
    ctx.strokeStyle = '#444';
    ctx.lineWidth = 2;
    
    // Yè½´
    ctx.beginPath();
    ctx.moveTo(margin, margin);
    ctx.lineTo(margin, h - margin);
    ctx.stroke();
    
    // Xè½´
    ctx.beginPath();
    ctx.moveTo(margin, h - margin);
    ctx.lineTo(w - margin, h - margin);
    ctx.stroke();
    
    // æ ‡ç­¾
    ctx.fillStyle = '#888';
    ctx.font = '14px Arial';
    ctx.fillText('ä»·æ ¼ P', margin - 10, margin - 15);
    ctx.fillText('æ•°é‡ Q', w - margin + 10, h - margin + 5);
    ctx.fillText('O', margin - 20, h - margin + 20);
}

// ç»˜åˆ¶éœ€æ±‚æ›²çº¿ï¼ˆå‘å³ä¸‹æ–¹å€¾æ–œï¼ï¼ä»·æ ¼è¶Šä½éœ€æ±‚é‡è¶Šå¤§ï¼ï¼ï¼‰
function drawDemandCurve(shift = 0) {
    const { w, h } = getSize();
    const margin = 60;
    
    ctx.strokeStyle = '#ff6b6b';
    ctx.lineWidth = 3;
    ctx.beginPath();
    
    for (let x = 0; x <= w - 2 * margin; x++) {
        const normalX = x / (w - 2 * margin);
        // éœ€æ±‚æ›²çº¿ï¼šxå¢åŠ ï¼Œyå¢åŠ ï¼ˆåœ¨canvasåæ ‡ç³»é‡Œyå‘ä¸‹æ˜¯å¢åŠ ï¼Œæ‰€ä»¥ä»·æ ¼é™ä½ï¼‰
        const y = normalX * (h - 2 * margin) * 0.8 + margin * 0.5;
        
        if (x === 0) {
            ctx.moveTo(margin + x, margin + y + shift);
        } else {
            ctx.lineTo(margin + x, margin + y + shift);
        }
    }
    ctx.stroke();
    
    // æ ‡ç­¾ - æ”¾åœ¨æ›²çº¿å³ä¸‹è§’
    ctx.fillStyle = '#ff6b6b';
    ctx.font = 'bold 16px Arial';
    ctx.fillText('D (éœ€æ±‚)', w - margin - 60, h - margin - 30 + shift);
}

// ç»˜åˆ¶ä¾›ç»™æ›²çº¿ï¼ˆå‘å³ä¸Šæ–¹å€¾æ–œï¼ï¼ä»·æ ¼è¶Šé«˜ä¾›ç»™é‡è¶Šå¤§ï¼ï¼ï¼‰
function drawSupplyCurve(shift = 0) {
    const { w, h } = getSize();
    const margin = 60;
    
    ctx.strokeStyle = '#4ecdc4';
    ctx.lineWidth = 3;
    ctx.beginPath();
    
    for (let x = 0; x <= w - 2 * margin; x++) {
        const normalX = x / (w - 2 * margin);
        // ä¾›ç»™æ›²çº¿ï¼šxå¢åŠ ï¼Œä»·æ ¼å¢åŠ ï¼ˆyå‡å°ï¼Œå› ä¸ºcanvasçš„yæ˜¯å‘ä¸‹çš„ï¼‰
        const y = (1 - normalX) * (h - 2 * margin) * 0.8 + margin * 0.5;
        
        if (x === 0) {
            ctx.moveTo(margin + x, margin + y + shift);
        } else {
            ctx.lineTo(margin + x, margin + y + shift);
        }
    }
    ctx.stroke();
    
    // æ ‡ç­¾ - æ”¾åœ¨æ›²çº¿å³ä¸Šè§’
    ctx.fillStyle = '#4ecdc4';
    ctx.font = 'bold 16px Arial';
    ctx.fillText('S (ä¾›ç»™)', w - margin - 60, margin + 30 + shift);
}

// ç»˜åˆ¶å‡è¡¡ç‚¹
function drawEquilibrium(visible = false, pulse = false) {
    if (!visible) return;
    
    const { w, h } = getSize();
    const margin = 60;
    
    // å‡è¡¡ç‚¹ä½ç½®ï¼ˆæ›²çº¿äº¤ç‚¹ï¼‰
    const eqX = margin + (w - 2 * margin) * 0.5;
    const eqY = margin + (h - 2 * margin) * 0.5;
    
    // è™šçº¿åˆ°åæ ‡è½´
    ctx.strokeStyle = '#ff9900';
    ctx.lineWidth = 1;
    ctx.setLineDash([5, 5]);
    
    ctx.beginPath();
    ctx.moveTo(eqX, eqY);
    ctx.lineTo(margin, eqY);
    ctx.stroke();
    
    ctx.beginPath();
    ctx.moveTo(eqX, eqY);
    ctx.lineTo(eqX, h - margin);
    ctx.stroke();
    
    ctx.setLineDash([]);
    
    // å‡è¡¡ç‚¹
    const radius = pulse ? 12 + Math.sin(Date.now() / 100) * 4 : 8;
    
    ctx.beginPath();
    ctx.arc(eqX, eqY, radius, 0, Math.PI * 2);
    ctx.fillStyle = '#ff9900';
    ctx.fill();
    
    // æ ‡ç­¾
    ctx.fillStyle = '#ff9900';
    ctx.font = 'bold 14px Arial';
    ctx.fillText('P*', margin - 30, eqY + 5);
    ctx.fillText('Q*', eqX - 5, h - margin + 25);
    ctx.fillText('E', eqX + 15, eqY - 10);
}

// ç»˜åˆ¶çœ‹ä¸è§çš„æ‰‹
function drawHand(x, y, opacity = 1) {
    ctx.font = '50px Arial';
    ctx.globalAlpha = opacity;
    ctx.fillText('ğŸ‘‹', x - 25, y + 15);
    ctx.globalAlpha = 1;
}

// ç»˜åˆ¶æ¶ˆè´¹è€…å‰©ä½™å’Œç”Ÿäº§è€…å‰©ä½™
function drawSurplus(visible = false) {
    if (!visible) return;
    
    const { w, h } = getSize();
    const margin = 60;
    
    const eqX = margin + (w - 2 * margin) * 0.5;
    const eqY = margin + (h - 2 * margin) * 0.5;
    
    // æ¶ˆè´¹è€…å‰©ä½™ï¼ˆå‡è¡¡ä»·æ ¼ä»¥ä¸Šï¼Œéœ€æ±‚æ›²çº¿ä»¥ä¸‹çš„ä¸‰è§’å½¢ï¼‰
    // éœ€æ±‚æ›²çº¿ä»å·¦ä¸Šåˆ°å³ä¸‹ï¼Œæ‰€ä»¥æ¶ˆè´¹è€…å‰©ä½™åœ¨å‡è¡¡ç‚¹ä¸Šæ–¹
    ctx.fillStyle = 'rgba(255, 107, 107, 0.3)';
    ctx.beginPath();
    ctx.moveTo(margin, margin + margin * 0.5); // éœ€æ±‚æ›²çº¿èµ·ç‚¹ï¼ˆå·¦ä¸Šï¼Œé«˜ä»·æ ¼ä½éœ€æ±‚ï¼‰
    ctx.lineTo(eqX, eqY); // å‡è¡¡ç‚¹
    ctx.lineTo(margin, eqY); // å‡è¡¡ä»·æ ¼æ°´å¹³çº¿ä¸Yè½´äº¤ç‚¹
    ctx.closePath();
    ctx.fill();
    
    // ç”Ÿäº§è€…å‰©ä½™ï¼ˆå‡è¡¡ä»·æ ¼ä»¥ä¸‹ï¼Œä¾›ç»™æ›²çº¿ä»¥ä¸Šçš„ä¸‰è§’å½¢ï¼‰
    // ä¾›ç»™æ›²çº¿ä»å·¦ä¸‹åˆ°å³ä¸Š
    ctx.fillStyle = 'rgba(78, 205, 196, 0.3)';
    ctx.beginPath();
    ctx.moveTo(margin, h - margin - margin * 0.5); // ä¾›ç»™æ›²çº¿èµ·ç‚¹ï¼ˆå·¦ä¸‹ï¼Œä½ä»·æ ¼ä½ä¾›ç»™ï¼‰
    ctx.lineTo(eqX, eqY); // å‡è¡¡ç‚¹
    ctx.lineTo(margin, eqY); // å‡è¡¡ä»·æ ¼æ°´å¹³çº¿ä¸Yè½´äº¤ç‚¹
    ctx.closePath();
    ctx.fill();
}

// ä¸»ç»˜åˆ¶å‡½æ•°
function draw(progress) {
    const { w, h } = getSize();
    ctx.clearRect(0, 0, w, h);
    
    // é˜¶æ®µåˆ’åˆ†
    // 0-20%: å‡ºç°åæ ‡è½´å’Œæ›²çº¿
    // 20-60%: æ‰‹å‡ºç°å¹¶å¼•å¯¼
    // 60-80%: è¾¾åˆ°å‡è¡¡
    // 80-100%: å±•ç¤ºå‰©ä½™ï¼Œé«˜æ½®
    
    drawAxes();
    
    if (progress < 0.2) {
        // æ›²çº¿æ¸å…¥
        const curveProgress = progress / 0.2;
        ctx.globalAlpha = curveProgress;
        drawDemandCurve(50 * (1 - curveProgress));
        drawSupplyCurve(-50 * (1 - curveProgress));
        ctx.globalAlpha = 1;
        
        status.textContent = 'å¸‚åœºå‚ä¸è€…å…¥åœºä¸­...';
        status.classList.add('visible');
        
    } else if (progress < 0.6) {
        // æ‰‹å¼•å¯¼é˜¶æ®µ
        const handProgress = (progress - 0.2) / 0.4;
        
        drawDemandCurve();
        drawSupplyCurve();
        
        // æ‰‹ä»å³è¾¹ç§»åŠ¨åˆ°ä¸­é—´
        const margin = 60;
        const handX = w - margin - 50 - (w - 2 * margin - 100) * 0.5 * handProgress;
        const handY = h / 2 + Math.sin(handProgress * Math.PI * 4) * 30;
        
        drawHand(handX, handY, 0.7);
        
        if (handProgress < 0.3) {
            status.textContent = 'çœ‹ä¸è§çš„æ‰‹å‡ºç°äº†...';
        } else if (handProgress < 0.7) {
            status.textContent = 'ä»·æ ¼ä¿¡å·ä¼ é€’ä¸­...';
        } else {
            status.textContent = 'ä¾›éœ€åŒæ–¹æ­£åœ¨è°ƒæ•´...';
        }
        status.classList.add('visible');
        
    } else if (progress < 0.8) {
        // å‡è¡¡è¾¾æˆ
        const eqProgress = (progress - 0.6) / 0.2;
        
        drawDemandCurve();
        drawSupplyCurve();
        drawEquilibrium(true, false);
        
        const margin = 60;
        const eqX = margin + (w - 2 * margin) * 0.5;
        const eqY = margin + (h - 2 * margin) * 0.5;
        drawHand(eqX + 30, eqY, 0.5 * (1 - eqProgress));
        
        status.textContent = 'âœ¨ å‡è¡¡è¾¾æˆï¼å¸‚åœºå‡ºæ¸…ï¼ âœ¨';
        status.classList.add('visible');
        
    } else {
        // æœ€ç»ˆé˜¶æ®µï¼šå±•ç¤ºå‰©ä½™ï¼Œè„‰å†²æ•ˆæœ
        drawSurplus(true);
        drawDemandCurve();
        drawSupplyCurve();
        drawEquilibrium(true, true);
        
        climax.classList.add('visible');
        
        const finalProgress = (progress - 0.8) / 0.2;
        if (finalProgress < 0.5) {
            status.textContent = 'ğŸ”¥ å¸•ç´¯æ‰˜æœ€ä¼˜å·²è¾¾æˆï¼ğŸ”¥';
        } else {
            status.textContent = 'ğŸ’° æ¶ˆè´¹è€…å‰©ä½™ + ç”Ÿäº§è€…å‰©ä½™ = æœ€å¤§åŒ–ï¼ ğŸ’°';
        }
        status.classList.add('visible');
    }
}

// åŠ¨ç”»å¾ªç¯
function animate(timestamp) {
    if (!startTime) startTime = timestamp;
    
    const elapsed = timestamp - startTime;
    progress = Math.min(elapsed / duration, 1);
    
    draw(progress);
    
    // æ›´æ–°è¿›åº¦æ¡
    progressFill.style.width = (progress * 100) + '%';
    const currentSec = Math.floor(elapsed / 1000);
    const totalSec = Math.floor(duration / 1000);
    timeDisplay.textContent = `0:${currentSec.toString().padStart(2, '0')} / 0:${totalSec}`;
    
    if (progress < 1) {
        animationId = requestAnimationFrame(animate);
    } else {
        isPlaying = false;
        playBtn.textContent = 'â†» é‡æ’­';
    }
}

// æ’­æ”¾/æš‚åœ
playBtn.addEventListener('click', () => {
    if (isPlaying) {
        cancelAnimationFrame(animationId);
        isPlaying = false;
        playBtn.textContent = 'â–¶ ç»§ç»­';
    } else {
        if (progress >= 1) {
            // é‡æ’­
            progress = 0;
            startTime = null;
            climax.classList.remove('visible');
        }
        isPlaying = true;
        playBtn.textContent = 'â¸ æš‚åœ';
        animationId = requestAnimationFrame(animate);
    }
});

// åˆå§‹ç»˜åˆ¶
draw(0);
status.textContent = 'ç‚¹å‡»æ’­æ”¾ï¼Œè§è¯å¸‚åœºçš„å¥‡è¿¹';
status.classList.add('visible');
</script>

</body>
</html>
